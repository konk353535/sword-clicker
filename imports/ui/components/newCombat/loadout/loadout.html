<template name="loadoutPage">
  <div class="container mt-2">
    {{#if classFeatureUnlocked}}
    <h4 class="d-flex align-items-center">
      Class
    </h4>
    <div class="hide-on-mobile">
      <div class="d-flex flex-wrap mb-3">
        <div class="mr-2 hidden-sm-down" style="line-height: 2.33em;">Active Class</div>
        <div class="dropdown">
          <button class="btn btn-secondary mr-3 dropdown-toggle text-capitalize" type="button"
            id="dropDownClassPCButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{currentClass}}
          </button>
          <div class="dropdown-menu" aria-labelledby="dropDownClassPCButton">
            <a class="dropdown-item select-class" data-class="wanderer" href="#">Wanderer</a>
            <a class="dropdown-item select-class" data-class="barbarian" href="#">Barbarian</a>
            <a class="dropdown-item select-class" data-class="duelist" href="#">Duelist</a>
            <a class="dropdown-item select-class" data-class="paladin" href="#">Paladin</a>
            <a class="dropdown-item select-class" data-class="ranger" href="#">Ranger</a>
            <a class="dropdown-item select-class" data-class="sage" href="#">Sage</a>
            <a class="dropdown-item select-class" data-class="tactician" href="#">Tactician</a>
            <a class="dropdown-item select-class" data-class="warmage" href="#">War Mage</a>
            <a class="dropdown-item select-class" data-class="wizard" href="#">Wizard</a>
          </div>
        </div>
        <div class="mr-2" style="line-height: 2.33em; margin-top: -10px;">
          <img width="56" height="56" src="/icons/{{currentClassIcon}}" style="border: none; width: 56px; height: 56px;" />
          <button type="button" class="btn btn-primary view-classes-btn" style="width: 120px; margin-left: 10px;">Classes info</button>
          <button type="button" class="btn btn-warning reset-cooldown-btn" style="width: 195px; margin-left: 10px;">Reset cooldown <img src="/icons/classCooldownResetToken.svg" style="width: 20px; height: 20px; margin-top: -4px;">{{resetTokenCount}}</button>
        </div>
      </div>
      {{#if classChangeCooldown}}
      <div style="margin-top: -18px; margin-bottom: 24px;" class="{{classChangeCooldownStyle}}">
        You have changed to another class recently.  Your cooldown before you can change again expires in {{>readableDuration endDate=classChangeCooldown}}.<br />
      </div>
      {{/if}}
    </div>
    <div class="hide-on-desktop" style="margin-bottom: 16px;">
      <div class="d-flex flex-wrap mb-3">
        <div class="dropdown">
          <button class="btn btn-secondary mr-3 dropdown-toggle text-capitalize" type="button"
            id="dropDownClassMobileButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{currentClass}}
          </button>
          <div class="dropdown-menu" aria-labelledby="dropDownClassMobileButton">
            <a class="dropdown-item select-class" data-class="wanderer" href="#">Wanderer</a>
            <a class="dropdown-item select-class" data-class="barbarian" href="#">Barbarian</a>
            <a class="dropdown-item select-class" data-class="duelist" href="#">Duelist</a>
            <a class="dropdown-item select-class" data-class="paladin" href="#">Paladin</a>
            <a class="dropdown-item select-class" data-class="ranger" href="#">Ranger</a>
            <a class="dropdown-item select-class" data-class="sage" href="#">Sage</a>
            <a class="dropdown-item select-class" data-class="tactician" href="#">Tactician</a>
            <a class="dropdown-item select-class" data-class="warmage" href="#">War Mage</a>
            <a class="dropdown-item select-class" data-class="wizard" href="#">Wizard</a>
          </div>
        </div>
        <div class="mr-2" style="line-height: 2.33em; margin-top: -10px;">
          <img width="56" height="56" src="/icons/{{currentClassIcon}}" style="border: none; width: 56px; height: 56px;" />
          <button type="button" class="btn btn-primary view-classes-btn" style="width: 50px; margin-left: 10px;">?</button>
        </div>
      </div>
      <div class="d-flex flex-grow justify-content-center" style="line-height: 2.33em; margin-top: -10px;">
        <button type="button" class="btn btn-warning reset-cooldown-btn" style="width: 195px; margin-left: 10px;">Reset cooldown <img src="/icons/classCooldownResetToken.svg" style="width: 20px; height: 20px; margin-top: -4px;">{{resetTokenCount}}</button>
      </div>
      {{#if classChangeCooldown}}
        <div style="margin-top: 8px; margin-bottom: 24px;" class="{{classChangeCooldownStyle}}">
          You have changed to another class recently.  Your cooldown before you can change again expires in {{>readableDuration endDate=classChangeCooldown}}.<br />
        </div>
      {{/if}}
    </div>
    {{/if}}
    <h4 class="d-flex align-items-center">
      Gear
      <a href="#" class="ml-3 edit-gear-btn" style="font-size: 14px">Edit</a>
      <a href="#" class="ml-3 remove-all-gear-btn" style="font-size: 14px">Remove All</a>
    </h4>
    <div class="d-flex flex-wrap mb-3">
      <!-- Main Hand -->
      {{#if equippedItemsMap.mainHand}}
        {{> itemIcon item=equippedItemsMap.mainHand}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Main Hand
          </div>
        </a>
      {{/if}}
      <!-- Off Hand -->
      {{#if equippedItemsMap.offHand}}
        {{> itemIcon item=equippedItemsMap.offHand}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Off Hand
          </div>
        </a>
      {{/if}}
      <!-- Neck -->
      {{#if equippedItemsMap.neck}}
        {{> itemIcon item=equippedItemsMap.neck}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Neck
          </div>
        </a>
      {{/if}}
      <!-- Head -->
      {{#if equippedItemsMap.head}}
        {{> itemIcon item=equippedItemsMap.head}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Head
          </div>
        </a>
      {{/if}}
      <!-- Chest -->
      {{#if equippedItemsMap.chest}}
        {{> itemIcon item=equippedItemsMap.chest}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Chest
          </div>
        </a>
      {{/if}}
      <!-- Legs -->
      {{#if equippedItemsMap.legs}}
        {{> itemIcon item=equippedItemsMap.legs}}
      {{else}}
        <a href="#" class="edit-gear-btn">
          <div class="icon-box">
            Legs
          </div>
        </a>
      {{/if}}
    </div>
    <h4 class="d-flex align-items-center">
      Abilities
      <a href="#" class="ml-3 edit-abilities-btn" style="font-size: 14px">Edit</a>
      <a href="#" class="ml-3 remove-all-abilities-btn" style="font-size: 14px">Remove All</a>
    </h4>
    <div class="d-flex flex-wrap mb-3">
      {{#if classFeatureUnlocked}}
        <!-- Main Hand -->
        {{#if equippedAbilitiesMap.mainHand}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.mainHand}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              1
              {{#if $neq isTactician true}}
                <br />Active
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- Off Hand -->
        {{#if equippedAbilitiesMap.offHand}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.offHand}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              2
              {{#if $neq isTactician true}}
                <br />Active
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- Head -->
        {{#if equippedAbilitiesMap.head}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.head}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              3
              {{#if $neq isTactician true}}
                <br />Active
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- Chest -->
        {{#if equippedAbilitiesMap.chest}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.chest}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              4
              {{#if $neq isTactician true}}
                <br />Active
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- Legs -->
        {{#if equippedAbilitiesMap.legs}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.legs}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              5
              {{#if $neq isTactician true}}
                <br />Active
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- classAbil1 -->
        {{#if equippedAbilitiesMap.classAbil1}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.classAbil1}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              6
              {{#if $neq isTactician true}}
                <br />Passive
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- classAbil2 -->
        {{#if equippedAbilitiesMap.classAbil2}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.classAbil2}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              7
              {{#if $neq isTactician true}}
                <br />Passive
              {{/if}}
            </div>
          </a>
        {{/if}}
        <!-- classAbil3 -->
        {{#if equippedAbilitiesMap.classAbil3}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.classAbil3}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box" style="text-align: center;">
              8
              {{#if $neq isTactician true}}
                <br />Passive
              {{/if}}
            </div>
          </a>
        {{/if}}
      {{else}}
        <!-- Main Hand -->
        {{#if equippedAbilitiesMap.mainHand}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.mainHand}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box">
              1
            </div>
          </a>
        {{/if}}
        <!-- Off Hand -->
        {{#if equippedAbilitiesMap.offHand}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.offHand}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box">
              2
            </div>
          </a>
        {{/if}}
        <!-- Head -->
        {{#if equippedAbilitiesMap.head}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.head}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box">
              3
            </div>
          </a>
        {{/if}}
        <!-- Chest -->
        {{#if equippedAbilitiesMap.chest}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.chest}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box">
              4
            </div>
          </a>
        {{/if}}
        <!-- Legs -->
        {{#if equippedAbilitiesMap.legs}}
          {{> abilityLibraryIcon item=equippedAbilitiesMap.legs}}
        {{else}}
          <a href="#" class="edit-abilities-btn">
            <div class="icon-box">
              5
            </div>
          </a>
        {{/if}}
      {{/if}}
      <!-- Companion -->
      {{#if equippedAbilitiesMap.companion}}
        {{> abilityLibraryIcon item=equippedAbilitiesMap.companion}}
      {{else}}
        <a href="#" class="edit-abilities-btn">
          <div class="icon-box">
            Companion
          </div>
        </a>
      {{/if}}
    </div>
    <h4>Skins</h4>
    <div class="d-flex flex-wrap mb-3">
      {{#each skinsLibrary}}
        {{> skinLibraryIcon skin=this}}
      {{/each}}
    </div>

    <div class="d-flex flex-grow justify-content-center" style="margin-top: 30px">
      <button type="button" class="btn btn-primary back-to-lobby-btn" style="width: 150px">Back to lobby</button>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal classSelectionConfirm" tabindex="-1" role="dialog" aria-labelledby="classSelectionConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="classSelectionConfirmModalLabel">Confirm Class Change</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          Are you sure you want to class change to become a <b>{{classChangeSelectionChoice}}</b>?<br />
          
          {{#if $neq currentClass 'Wanderer'}}
            <br />
            Access to all abilities and traits unique to {{currentClass}}s will be removed and all of your existing
            equipment and abilities will be unequipped as part of the class change.<br />
            <br />
            Your reforge queue will be cancelled and those items returned to you.  Classes can change how items are
            reforged.<br />
          {{/if}}
          
          {{#if $neq classChangeSelectionChoice 'Wanderer'}}
            <br />
            You will not be able change your class selection again for the next 15 minutes.<br />
          {{/if}}
        </div>
        <div class="modal-footer">
          <div class="row" style="width:100%">
            <div class="col-md-6">
              <button type="button" class="btn btn-success" data-dismiss="modal">Cancel</button>
            </div>
            <div class="col-md-6 hide-on-mobile">
              <button type="button" class="btn btn-primary view-classes-btn" data-dismiss="modal" style="width: 120px; margin-right: 10px;">More info</button>
            </div>
          </div>
          <div class="col-md-6">
            <button type="button" class="btn btn-danger chance-class-confirm-btn pull-left">
              Change to {{classChangeSelectionChoice}} 
              <img src="/icons/{{classChangeSelectionChoiceIcon}}" style="width: 24px; height: 24px; margin-top: -2px;" />
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

</template>

<template name="skinLibraryIcon">
  <div class="icon-box p-3
    {{#if skin.disabled}} cursor-not-allowed{{else}} cursor-pointer{{/if}}
    {{#if skin.disabled}} disabled{{/if}}
    {{#if skin.selected}} equipped-icon{{/if}}">
    <img src="/icons/{{skin.icon}}">
  </div>

  <!-- Icon Tooltip -->
  <div class="skin-tooltip-content my-tooltip-inner">
    <h3 class="popover-title text-capitalize">
      {{skin.name}}
    </h3>
    <div class="popover-content">
      <div style="max-width: 350px;">
        {{{description}}}
      </div>
    </div>
  </div>
</template>

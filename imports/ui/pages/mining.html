<template name="miningPage">

  {{> skillHeader skill=miningSkill}}

  <!--
  <div class="d-flex flex-wrap">
    {{#each miningItems}}
      {{> itemIcon item=this classes="small"}}
    {{/each}}
  </div>
  -->

  {{#if false}}
  <h2>Mining Upgrades</h2>
  <div class="d-flex flex-row flex-wrap">

    <div class="d-flex flex-column align-items-center justify-content-center">
      <div class="icon-box buy-miner" style="cursor: pointer;">
        <img src="/icons/miner.svg" class="ore-icon">
      </div>
      <div class="d-flex">
        {{summaryMiners.count}} / {{summaryMiners.max}}
      </div>
    </div>

    <!-- Tooltip for buy miner icon -->
    <div class="miners-tooltip-content my-tooltip-inner">
      <h3 class='popover-title text-capitalize'>Miners</h3>
      <div class='popover-content'>
        Auto mine ores over time.<br /><br />
        <b>Click</b> to view upgrades
      </div>
    </div>

    <div class="d-flex flex-column align-items-center justify-content-center">
      <div class="icon-box buy-prospector" style="cursor: pointer;">
        <img src="/icons/prospector.svg" class="ore-icon">
      </div>
      <div class="d-flex">
        {{summaryProspectors.count}} / {{summaryProspectors.max}}
      </div>
    </div>

    <!-- Tooltip for buy prospector icon -->
    <div class="prospectors-tooltip-content my-tooltip-inner">
      <h3 class='popover-title text-capitalize'>Prospectors</h3>
      <div class='popover-content'>
        Increase the chance of finding specific ores<br /><br />
        <b>Click</b> to view upgrades
      </div>
    </div>
    {{#if equippedItemsMap.pickaxe}}
      <div class="d-flex flex-column align-items-center justify-content-center equipped-pickaxe">
        {{> itemIcon item=equippedItemsMap.pickaxe}}
        <div class="d-flex">
          {{> formatNumber number=mining.stats.energy}} / {{mining.stats.energyStorage}}
        </div>
      </div>
      <div class="d-flex flex-column ml-3">
        <div class="d-flex align-items-center">
          {{#if hasMiningUpgrade}}
            ({{mining.stats.attack}}
            {{> memberBenefit bonusKey='miningAttackBonus' value=mining.stats.attack}})
          {{else}}
            {{mining.stats.attack}}
          {{/if}}
          <i class="lilIcon-attack mx-1"></i> Damage per click.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyStorage}} <i class="lilIcon-energyStorage mx-1"></i> Max pickaxe energy.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyPerHit}} <i class="lilIcon-energyPerHit mx-1"></i> Energy per click.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyRegen}}<i class="lilIcon-energyRegen mx-1"></i> Energy regen per minute.
        </div>
        <div class="d-flex align-items-center">
          {{#if hasMiningUpgrade}}
            ({{mining.stats.miner}}
            {{> memberBenefit bonusKey='miningBonus' value=mining.stats.miner}})%
          {{else}}
            {{mining.stats.miner}}%
          {{/if}}
          <i class="lilIcon-miner mx-1"></i> Extra passive miner damage.
        </div>

      </div>
    {{else}}
      <div class="icon-box">
        Pickaxe
      </div>
    {{/if}}
  </div>
  {{/if}}

  <ul class="nav nav-tabs mb-3">
    <li class="nav-item">
      <a class="nav-link active" href="#">Mine Pit</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Equipment</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Miners</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Prospectors</a>
    </li>
  </ul>

  <div class="d-flex align-items-center">
    <div class="d-flex flex-column mb-3" style="width: 200px">
      <div class="d-flex align-items-center">
        <i class="lilIcon-mining extra-small-icon mr-1"></i> 
        {{> formatNumber number=mining.stats.energy}} / {{> formatNumber number=mining.stats.energyStorage}}
      </div>
      <div class="progress mt-1" style="width: 100%">
        <div class="progress-bar bg-warning" role="progressbar" style="width: {{miningEnergyPercentage}}%" aria-valuenow="{{miningEnergyPercentage}}" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div class="d-flex flex-row flex-wrap" style="max-width: 420px">
        {{#each miningSpaces}}
          {{> mineSpace mineSpace=this}}
        {{/each}}
      </div>
    </div>
    <div class="col-md-6">
      <div class="d-flex flex-column flex-wrap" style="max-height: 420px">
        {{#each oresList}}
          {{> oreListItem ore=this}}
        {{/each}}
      </div>
    </div>
  </div>

  <!-- Miners Modal -->
  <div class="modal minersModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Miners</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-bordered table-hover table-centered table-responsive">
            <thead>
              <tr>
                <th>Name</th>
                <th class="hidden-md-down">Icon</th>
                <th>Requirements</th>
                <th>Count</th>
                <th>Damage / Hour</th>
              </tr>  
            </thead>
            <tbody>
              {{#each buyableMiners}}
                <tr class="miner-row text-center" style="cursor: pointer" data-miner={{this.id}}>
                  <td class="text-capitalize">{{this.name}}</td>
                  <td class="hidden-md-down">
                    <img src="/icons/{{this.icon}}.svg" class="ore-icon">
                  </td>
                  <td>{{ > requiredItems requiredItems=this.required}}</td>
                  <td>{{this.amount}} / {{this.max}}</td>
                  <td>
                    {{#if this.amount}}
                      {{> formatNumber number=this.damagePerHour}}
                    {{else}}
                      <span class="text-muted">
                        {{> formatNumber number=this.damagePerHour}}
                      </span>
                    {{/if}}
                  </td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Prospectors Modal -->
  <div class="modal prospectorsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Prospectors</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-bordered table-centered table-responsive">
            <thead>
              <tr>
                <th>Name</th>
                <th class="hidden-md-down">Icon</th>
                <th>Requirements</th>
                <th>Count</th>
                <th>Actions</th>
              </tr>  
            </thead>
            <tbody>
              {{#each buyableProspectors}}
                <tr class="prospector-row text-center">
                  <td class="text-capitalize">{{this.name}}</td>
                  <td class="hidden-md-down">
                    <img src="/icons/{{this.icon}}.svg" class="ore-icon">
                  </td>
                  <td>{{ > requiredItems requiredItems=this.required}}</td>
                  <td>{{this.amount}} / {{this.max}}</td>
                  <td>
                    <button class="btn btn-primary m-1 prospector-hire" data-prospector={{this.id}}>
                      Hire
                    </button>
                    <button class="btn btn-danger m-1 prospector-fire" data-prospector={{this.id}}>
                      Fire
                    </button>
                  </td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</template>

<template name="oreListItem">
  <div class="ore-list-item">
    <img src="/icons/{{ore.icon}}.svg" class="icon-box small-icon"> {{ore.amount}}
  </div>

  <div class="ore-list-item-tooltip-content my-tooltip-inner">
    <h3 class='popover-title text-capitalize'>{{ore.name}}</h3>
  </div>
</template>

<template name="miningPage">
  <div class="container mt-3">
  <div class="row">
    <div class="col-md-6">
      <div class="d-flex flex-column mb-3">
        <div class="d-flex align-items-center mb-1" style="flex: 1">
          <div class="d-flex flex-column">
            <div class="d-flex align-items-center">
              <img src="/icons/energy.svg" class="extra-small-icon mr-1">
              {{> formatNumber number=mining.stats.energy}} / {{> formatNumber number=mining.stats.energyStorage}}
            </div>
          </div>
          <!--
          <div class="d-flex align-items-center justify-content-end">
            <button class='btn btn-secondary multihit-btn btn-sm ml-4'>Enable Multihit</button>
            <input type='hidden' class='multihit-value' value=0 />
          </div>-->
        </div>
        <div class="d-flex flex-row flex-wrap" style="max-width: 420px">
          {{#each miningSpaces}}
            {{> mineSpace mineSpace=this}}
          {{/each}}
        </div>

        <h3 style="margin-top: 30px">Gear</h3>
        <div class="d-flex flex-row flex-wrap mb-3">
          {{#if equippedItemsMap.pickaxe}}
            <div class="d-flex flex-column align-items-center justify-content-center equipped-pickaxe">
              {{> itemIcon item=equippedItemsMap.pickaxe}}
              <div class="d-flex">
                {{> formatNumber number=mining.stats.energy}} / {{> formatNumber number=mining.stats.energyStorage}}
              </div>
            </div>
          {{else}}
            <div class="icon-box">
              Pickaxe
            </div>
          {{/if}}
          {{#if equippedItemsMap.mining_offhand}}
            <div class="d-flex flex-column align-items-center justify-content-center equipped-mining-offhand">
              {{> itemIcon item=equippedItemsMap.mining_offhand}}
              <div class="d-flex">
                {{> formatNumber number=mining.stats.energy}} / {{> formatNumber number=mining.stats.energyStorage}}
              </div>
            </div>
          {{else}}
            <div class="icon-box">
              Offhand
            </div>
          {{/if}}
          <div class="d-flex flex-column ml-3">
            <div class="d-flex align-items-center">
              {{#if hasMiningUpgrade}}
                ({{mining.stats.attack}}
                {{> memberBenefit bonusKey='miningAttackBonus' value=mining.stats.attack}})
              {{else}}
                {{mining.stats.attack}}
              {{/if}}
              <i class="lilIcon-attack mx-1"></i> Damage per click.
            </div>
            <div class="d-flex align-items-center">
              {{mining.stats.energyStorage}} <i class="lilIcon-energyStorage mx-1"></i> Max pickaxe energy.
            </div>
            <div class="d-flex align-items-center">
              {{mining.stats.energyPerHit}} <i class="lilIcon-energyPerHit mx-1"></i> Energy per click.
            </div>
            <div class="d-flex align-items-center">
              {{mining.stats.energyRegen}}<i class="lilIcon-energyRegen mx-1"></i> Energy regen per minute.
            </div>
            <div class="d-flex align-items-center">
              {{#if hasMiningUpgrade}}
                ({{mining.stats.miner}}
                {{> memberBenefit bonusKey='miningBonus' value=mining.stats.miner}})%
              {{else}}
                {{mining.stats.miner}}%
              {{/if}}
              <i class="lilIcon-miner mx-1"></i> Extra passive miner damage.
            </div>
          </div>
        </div>

        {{#each miningPickaxes}}
          {{> itemIcon item=this classes="small"}}
        {{else}}
          No pickaxes in inventory
        {{/each}}
      </div>
    </div>
    <div class="col-md-6">
      <div class="d-flex align-items-center mb-1">
        <h3 class="mb-0 mr-3">Cart</h3>
        <button class="btn btn-primary btn-sm">
          Collect
        </button>
      </div>
      <div class="d-flex flex-wrap">
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/stone.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/copper.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/copper.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/copper.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/copper.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
        <div class="d-flex icon-box-new mr-1 mt-1 p-2">
          <div class="ore-list-item align-items-center d-flex">
            <img src="/icons/copper.png" class="extra-small-icon">
            <div>300 / 500</div>
          </div>
        </div>
      </div>

      <div class="d-flex mb-2" style="margin-top: 30px">
        <span class="mr-2">Prospecting</span>
        <div class="ore-list-item align-items-center d-flex mr-2">
          <img src="/icons/stone.png" class="extra-small-icon">
        </div>
        <div class="ore-list-item align-items-center d-flex mr-2">
          <img src="/icons/stone.png" class="extra-small-icon">
        </div>
        <a href="#">edit</a>
        <!--
        {{#each oresList}}
          {{> oreListItem ore=this}}
        {{/each}}
        -->
      </div>
      <div class="d-flex flex-wrap">
        {{#each buyableMiners}}
          {{> buyableMiner miner=this}}
        {{/each}}
      </div>
    </div>
  </div>
  </div>
</template>

<template name="hireMinerButton">

  {{#if $lt recipe.amount 3}}
    <!--
    <div>{{ > requiredItems requiredItems=this.required}}</div>
    <div>{{this.amount}} / {{this.max}}</div>-->
    <button class="btn btn-primary hire-miner">
      <span class="px-1">Hire</span>
    </button>
  {{/if}}

  {{#if showModal}}
    <div class="modal hireMinerModal" tabindex="-1" role="dialog" aria-labelledby="hireMinerModal" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <div class="d-flex flex-column">
              <h5 class="modal-title text-capitalize">
                {{recipe.name}}
              </h5>
              <small>{{recipe.description}}</small>
            </div>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form class="craft-amount-form">
            <div class="modal-body">
              {{ > requiredItemsList requiredItems=recipe.required recipeName=recipe.name duration=0}}

              {{#if recipe.baseStats}}
                {{#if showStats}}
                  <a href="#" class="hide-stats">Hide Stat Range</a>
                  {{> displayCombatStats stats=recipe.baseStats extraStats=recipe.extraStats}}
                  {{#if recipe.requiredEquip}}
                    <b>Equip Requirements</b>
                    <div class="d-flex flex-wrap">
                      {{#each recipe.requiredEquip}}
                        <i class="lilIcon-{{this.name}} extra-small-icon mx-1"></i>
                        {{this.level}}
                      {{/each}}
                    </div>
                  {{/if}}
                  {{#if recipe.isTwoHanded}}
                    <b>Two Handed</b>
                  {{/if}}
                {{else}}
                  <a href="#" class="show-stats">Show Stat Range</a>
                {{/if}}
              {{/if}}          
            </div>
            <div class="modal-footer">
              <div style="display: flex; flex: 1 1 auto;">
              </div>
              <button type="button" class="btn btn-primary confirm-hire-miner">
                Hire
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  {{/if}}
</template>

<template name="buyableMiner">
  <div class="buy-miner" data-miner="{{miner.id}}"
    style="border: 1px solid #DFDFDF; padding: 10px; margin: 0 10px 10px 0; min-width: calc(50% - 20px); flex: 1 1 auto; border-radius: 4px;">
    <div class="d-flex flex-wrap">
      <img src="/icons/{{miner.icon}}" class="medium-icon">
      <div class="mx-3 d-flex flex-column">
        <div class="text-capitalize">{{miner.name}}</div>
        <span class="damage-per-hour-container" style="min-width: 120px">
          Miners 0 / 3
          <!--
          {{#if miner.amount}}
            <div>DPH:
              <span class="text-info">
                {{> ceilNumber miner.damagePerHour}}
              </span>
            </div>
          {{else}}
            <div style="color: #DFDFDF">
              DPH: {{> ceilNumber miner.damagePerHour}}
            </div>
          {{/if}}-->
        </span>
      </div>
      <div class="mx-3" style="flex: 1 1; align-items: center;">
        <div class="d-flex">
          Mining <img src="/icons/stone.png" class="extra-small-icon ml-1">
        </div>
        <div style="flex: 1 1 auto; display: flex; align-items: center; height: 50%">
          32 DPS
        </div>
      </div>
      {{> hireMinerButton recipe=miner}} 
    </div>
  </div>

  <div class="dps-breakdown-tooltip-content my-tooltip-inner">
    <h3 class='popover-title text-capitalize'>DPS Breakdown</h3>
      <div class='popover-content'>
        Base DPS: {{> ceilNumber miner.baseDamagePerHour}}<br />
        Level Bonus: {{> ceilNumber miner.levelDps}}<br />
        Idol Bonus: {{> ceilNumber miner.minerStatDps}}<br />
        {{#if miner.donatorDps}}
          Donator Bonus: {{> ceilNumber miner.donatorDps}}
        {{/if}}
      </div>
    </div>
</template>

<template name="oreListItem">
  <div class="ore-list-item align-items-center d-flex mr-2">
    <img src="/icons/{{ore.icon}}" class="extra-small-icon">
    <div>{{ore.amount}}</div>
  </div>

  <div class="ore-list-item-tooltip-content my-tooltip-inner">
    <h3 class='popover-title text-capitalize'>{{ore.name}}</h3>
  </div>
</template>

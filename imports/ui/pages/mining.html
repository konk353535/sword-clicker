<template name="miningPage">

  {{> skillHeader skill=miningSkill}}

  <h2>Items</h2>
  <div class="d-flex flex-wrap">
    {{#each miningItems}}
      {{> itemIcon item=this classes="small"}}
    {{/each}}
  </div>

  <h2>Mining Upgrades</h2>
  <div class="d-flex flex-row flex-wrap">

    <div class="d-flex flex-column align-items-center justify-content-center">
      <div class="icon-box buy-miner" style="cursor: pointer;">
        <img src="/icons/miner.svg" class="ore-icon">
      </div>
      <div class="d-flex">
        {{> formatNumber totalDPH}} DPH
      </div>
    </div>

    <!-- Tooltip for buy miner icon -->
    <div class="miners-tooltip-content my-tooltip-inner">
      <h3 class='popover-title text-capitalize'>Miners</h3>
      <div class='popover-content'>
        Auto mine ores over time.<br /><br />
        Damage Per Hour <b>{{> formatNumber totalDPH}}</b>
        <br />
        <b>Click</b> to view upgrades
      </div>
    </div>

    <div class="icon-box buy-prospector" style="cursor: pointer;">
        <img src="/icons/prospector.svg" class="ore-icon">
    </div>

    <!-- Tooltip for buy prospector icon -->
    <div class="prospectors-tooltip-content my-tooltip-inner">
      <h3 class='popover-title text-capitalize'>Prospectors</h3>
      <div class='popover-content'>
        Increase the chance of finding ores
        <br />
        <b>Click</b> to view upgrades
      </div>
    </div>
    {{#if equippedItemsMap.pickaxe}}
      <div class="d-flex flex-column align-items-center justify-content-center equipped-pickaxe">
        {{> itemIcon item=equippedItemsMap.pickaxe}}
        <div class="d-flex">
          {{> formatNumber mining.stats.energy}} / {{mining.stats.energyStorage}}
        </div>
      </div>
      <div class="d-flex flex-column ml-3">
        <div class="d-flex align-items-center">
          {{mining.stats.attack}}<i class="lilIcon-attack mx-1"></i> Damage per click.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyStorage}} <i class="lilIcon-energyStorage mx-1"></i> Max pickaxe energy.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyPerHit}} <i class="lilIcon-energyPerHit mx-1"></i> Energy per click.
        </div>
        <div class="d-flex align-items-center">
          {{mining.stats.energyRegen}}<i class="lilIcon-energyRegen mx-1"></i> Energy regen per minute.
        </div>
        <div class="d-flex align-items-center">
          {{#if isMember}}
            ({{mining.stats.miner}}
            {{> memberBenefit bonusKey='miningBonus' value=mining.stats.miner}})%
          {{else}}
            {{mining.stats.miner}}%
          {{/if}}
          <i class="lilIcon-miner mx-1"></i> Extra passive miner damage.
        </div>

      </div>
    {{else}}
      <div class="icon-box">
        Pickaxe
      </div>
    {{/if}}
  </div>

  <h2>Mine Shaft</h2>
  <div class="d-flex flex-row flex-wrap" style="max-width: 420px">
    {{#each miningSpaces}}
      {{> mineSpace mineSpace=this}}
    {{/each}}
  </div>

  <!-- Miners Modal -->
  <div class="modal minersModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Miners</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-bordered table-hover table-centered table-responsive">
            <thead>
              <tr>
                <th>Name</th>
                <th class="hidden-md-down">Icon</th>
                <th>Requirements</th>
                <th>Count</th>
                <th>Damage / Hour</th>
              </tr>  
            </thead>
            <tbody>
              {{#each buyableMiners}}
                <tr class="miner-row text-center" style="cursor: pointer" data-miner={{this.id}}>
                  <td class="text-capitalize">{{this.name}}</td>
                  <td class="hidden-md-down">
                    <img src="/icons/{{this.icon}}.svg" class="ore-icon">
                  </td>
                  <td>{{ > requiredItems requiredItems=this.required}}</td>
                  <td>{{this.amount}} / {{this.max}}</td>
                  <td>
                    {{#if this.amount}}
                      {{> formatNumber this.damagePerHour}}
                    {{else}}
                      <span class="text-muted">
                        {{> formatNumber this.damagePerHour}}
                      </span>
                    {{/if}}
                  </td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Prospectors Modal -->
  <div class="modal prospectorsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Prospectors</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-bordered table-centered table-responsive">
            <thead>
              <tr>
                <th>Name</th>
                <th class="hidden-md-down">Icon</th>
                <th>Requirements</th>
                <th>Count</th>
                <th>Actions</th>
              </tr>  
            </thead>
            <tbody>
              {{#each buyableProspectors}}
                <tr class="prospector-row text-center">
                  <td class="text-capitalize">{{this.name}}</td>
                  <td class="hidden-md-down">
                    <img src="/icons/{{this.icon}}.svg" class="ore-icon">
                  </td>
                  <td>{{ > requiredItems requiredItems=this.required}}</td>
                  <td>{{this.amount}} / {{this.max}}</td>
                  <td>
                    <button class="btn btn-primary m-1 prospector-hire" data-prospector={{this.id}}>
                      Hire
                    </button>
                    <button class="btn btn-danger m-1 prospector-fire" data-prospector={{this.id}}>
                      Fire
                    </button>
                  </td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</template>
